---
name: chat-worktree
description: チャットセッションごとの独立したGit Worktree管理。
---

# チャット専用Git Worktree管理スキル

このスキルは、Antigravityが各チャットセッション(`conversation-id`)ごとに独立したGit作業環境を構築できるようにします。

## 命令
1. セッションの開始時、現在の会話ID（`3857606c-76ab-479f-ae89-5a298c5bb9c5` など）に基づいたワークツリーが存在するか確認してください。
2. 存在しない場合、`scripts/manage_worktree.js` を実行して、ベースリポジトリから新しいワークツリーとブランチを作成してください。
3. ワークツリーを作成する際、Antigravityのコーパス制約を回避するため、リポジトリルート内の **`.worktrees/`** ディレクトリ（`.gitignore` に追加済み）を使用してください。
4. ワークツリー作成後は、以後の作業（CWDの指定やGit操作、ファイル編集等）は**必ずそのワークツリーディレクトリの絶対パス**を使用して行ってください。
5. **重要**: ベースリポジトリのパス（例: `v:\repos\...\vscode-markdown-comment\...`）を誤って使用しないよう、常にパスの起点を作業用ワークツリーに切り替えてください。
6. すべてのコミットは `chat-<conversation-id>` ブランチに対して行われる必要があります。

## ルール
- ベースリポジトリ（メインのリポジトリ）で直接 `git checkout` や `git commit` を実行しないでください。
- ブランチ名は必ず `chat-` プレフィックスに続けて会話IDを使用してください。
- ワークツリー作成後は、ベースリポジトリに戻らずそのディレクトリ内で完結させてください。

## クリーンアップ（削除方法）
不要になったワークツリーは、ベースリポジトリで以下のコマンドを実行して削除できます：
1. `git worktree remove <パス>` または `git worktree remove <ブランチ名>`
2. (オプション) 対応するブランチも削除する場合： `git branch -D <ブランチ名>`

自動クリーンアップが必要な場合は、`scripts/manage_worktree.js cleanup <conversation-id>` を実行してください。
